#!/usr/bin/env bash

set -eu

dir=${ASDF_DIR:-$HOME/.asdf}

if [[ -d $dir ]]; then
    cd "$dir"
    git pull origin master
else
    git clone https://github.com/asdf-vm/asdf.git "$dir"
    cd "$dir"
fi

. "$dir"/asdf.sh

plugins=(
    bun
    deno
    julia
    lua
    nim
    nodejs
    python
    ruby
    zig
)

for plugin in "${plugins[@]}"; do
    if [[ -d $dir/plugins/$plugin ]]; then
        asdf plugin update "$plugin"
    else
        asdf plugin add "$plugin"
    fi
    asdf global "$plugin" system
    asdf install "$plugin" latest
done

#!/usr/bin/env bash

# Install a rust toolchain and some tooling.

set -eu

if which rustup &>/dev/null; then
    rustup update
else
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --no-modify-path
fi

mkcd() {
    local dir=$1
    mkdir -p "$dir"
    cd "$dir"
}

mkcd ~/.local/share/zsh/site-functions
rustup completions zsh >_rustup
rustup completions zsh cargo >_cargo

mkcd ~/.local/share/bash-completion/completions
rustup completions bash >rustup
rustup completions bash cargo >cargo

export PATH=$HOME/.cargo/bin:$PATH

rustup target add wasm32-unknown-unknown
rustup component add rust-src rls clippy
cargo install cargo-{get,edit,generate}

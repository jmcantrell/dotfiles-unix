#!/usr/bin/env bash

set -euo pipefail

results_file=$(mktemp -t "${0##*/}.XXXXXXXXXX")
printf -v cleanup "rm %q" "$results_file"
trap '$cleanup' EXIT

sk --ansi --interactive --delimiter=: --multi \
    --bind='ctrl-a:select-all' \
    --cmd='rg --color=always --line-number --column "{}"' \
    --preview='previewer -g {2} {1}' --preview-window '+{2}-/2' \
    "$@" >"$results_file"

exec editor -q "$results_file"

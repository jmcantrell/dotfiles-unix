#!/usr/bin/env bash

# Show the root git directory.

set -eu

die() {
    printf "%s: line %s: %s\n" "$0" "${BASH_LINENO[0]}" "$1" >&2
    exit "${2:-1}"
}

path=${1:-$PWD}

if [[ -f $path ]]; then
    path=$(dirname "$path")
fi

while [[ -d $path && ! -e $path/.git ]]; do
    path+=/..
done

if [[ ! -d $path ]]; then
    die "no git repository found"
fi

realpath "$path"

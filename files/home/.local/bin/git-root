#!/usr/bin/env bash

# Show the root git directory.

set -euo pipefail

path=${1:-$PWD}

if [[ -f $path ]]; then
    dir=$(dirname "$path")
else
    dir=$path
fi

cur_dir=$dir

while [[ -d $cur_dir && ! -e $cur_dir/.git ]]; do
    cur_dir+=/..
done

if [[ ! -d $cur_dir ]]; then
    printf "Not a git working directory: %q\n" "$dir" >&2
    exit 1
fi

realpath "$cur_dir"

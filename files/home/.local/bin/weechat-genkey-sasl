#!/usr/bin/env bash

# Generate a SASL client key for a weechat IRC server.
# Usage: weechat-genkey-sasl SERVER_NAME

set -euo pipefail

if [[ ! -v 1 ]]; then
    printf "The first argument must be a server name\n" >&2
    exit 1
fi

name=$1
pem=${XDG_CONFIG_HOME:-$HOME/.config}/weechat/$name.pem

mkdir -p "$(dirname "$pem")"
openssl ecparam -genkey -name prime256v1 -out "$pem"

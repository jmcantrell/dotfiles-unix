#!/usr/bin/env bash

set -e

if which rustup >/dev/null 2>&1; then
    rustup update
else
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --no-modify-path
fi

export PATH=$HOME/.cargo/bin:$PATH

zsh_completions=$HOME/.local/share/zsh/functions
mkdir -p "$zsh_completions"
rustup completions zsh >"$zsh_completions/_rustup"
rustup completions zsh cargo >"$zsh_completions/_cargo"

bash_completions=$HOME/.local/share/bash-completion/completions
mkdir -p "$bash_completions"
rustup completions bash >"$bash_completions/rustup"
rustup completions bash cargo >"$bash_completions/cargo"

rustup component add rls

# install cargo {add,rm,upgrade} commands
cargo install cargo-edit

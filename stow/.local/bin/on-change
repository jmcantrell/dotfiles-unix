#!/usr/bin/env bash

# Run a command when any file changes in the given directory.
# Usage: on-change DIRECTORY COMMAND [ARGUMENT...]

set -eu

directory=${1:?missing directory to watch}
shift

trap 'kill $$' INT

while sleep 0.1; do
    find "$directory" -type f | entr -acd "$@" || continue
done

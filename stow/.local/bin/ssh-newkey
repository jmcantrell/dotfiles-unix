#!/usr/bin/env bash

# Create an ssh key with sensible defaults.
# Display the resulting public key and copy it to the clipboard.
# Usage: ssh-newkey [NAME]

set -eu

key_type=ed25519
key=$HOME/.ssh/${1:-id_$key_type}

ssh-keygen -t "$key_type" -f "$key" -C "$USER@$HOSTNAME"

pubkey=$key.pub

cat "$pubkey"

case $OSTYPE in
linux*) xsel -ib <"$pubkey" ;;
darwin*) pbcopy <"$pubkey" ;;
esac

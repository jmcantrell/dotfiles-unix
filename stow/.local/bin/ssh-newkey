#!/usr/bin/env bash

# Create an ssh key with sensible defaults.
# Display the resulting public key and copy it to the clipboard.
# Usage: ssh-newkey [NAME]

set -euo pipefail

key=$HOME/.ssh/${1:-id_rsa}
comment="$USER@$HOSTNAME $(date -I)"

ssh-keygen -t rsa -b 4096 -f "$key" -C "$comment"

pubkey=$key.pub

cat "$pubkey"

case $OSTYPE in
linux*) xsel -ib <"$pubkey" ;;
darwin*) pbcopy <"$pubkey" ;;
esac
